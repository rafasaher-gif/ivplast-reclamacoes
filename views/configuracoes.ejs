<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IVPLAST | Configura√ß√µes</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body{background:#f3f5f7;}
    .app{display:flex;min-height:100vh;}
    .sidebar{width:260px;background:#fff;border-right:1px solid #e9ecef;padding:18px 14px;position:sticky;top:0;height:100vh;}
    .nav a{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:10px;color:#344054;text-decoration:none;}
    .nav a:hover{background:#f2f4f7;}
    .nav a.active{background:#e8f2ff;color:#0b5ed7;font-weight:600;}
    .content{flex:1;padding:22px;}
    .panel{border:0;border-radius:14px;box-shadow:0 8px 22px rgba(0,0,0,.06);}
    .topbar{background:#fff;border:1px solid #e9ecef;border-radius:14px;padding:12px 14px;box-shadow:0 4px 18px rgba(0,0,0,.04);margin-bottom:18px;}
    .btn-primary{background:#1177cc;border-color:#1177cc;}
  </style>
</head>
<body>
<%
  const cfg = (typeof config !== 'undefined' && config) ? config : {
    adminEmail: "", adminName: "", databaseSSL: true
  };
%>

<div class="app">
  <aside class="sidebar">
    <div class="d-flex align-items-center gap-2 px-2 mb-3">
      <img src="https://dummyimage.com/120x34/ffffff/1177cc.png&text=IVPLAST" style="height:34px;" alt="IVPLAST">
      <div>
        <div class="fw-semibold">IVPLAST</div>
        <div class="small text-secondary">Ocorr√™ncias</div>
      </div>
    </div>
    <div class="nav flex-column">
      <a href="/dashboard">üè† Menu Principal</a>
      <a href="/novo">‚ûï Novo</a>
      <a href="/ocorrencias">üîé Busca por Ocorr√™ncia</a>
      <a href="/relatorios">üìä Relat√≥rios</a>
      <a class="active" href="/configuracoes">‚öôÔ∏è Configura√ß√µes</a>
      <a href="/auditoria">üßæ Auditoria</a>
      <hr class="my-2"/>
      <a href="/logout">üö™ Sair</a>
    </div>
  </aside>

  <main class="content">
    <div class="topbar">
      <div class="fw-semibold">Configura√ß√µes</div>
      <div class="small text-secondary">Par√¢metros do sistema (admin / sess√£o / banco).</div>
    </div>

    <% if (typeof success !== 'undefined' && success) { %>
      <div class="alert alert-success"><%= success %></div>
    <% } %>
    <% if (typeof error !== 'undefined' && error) { %>
      <div class="alert alert-danger"><%= error %></div>
    <% } %>

    <div class="row g-3">
      <div class="col-lg-6">
        <div class="card panel">
          <div class="card-body">
            <div class="fw-semibold mb-2">Admin</div>
            <form method="POST" action="/configuracoes/admin">
              <div class="mb-2">
                <label class="form-label small">Admin email</label>
                <input name="adminEmail" class="form-control" value="<%= cfg.adminEmail %>" placeholder="admin@empresa.com">
              </div>
              <div class="mb-2">
                <label class="form-label small">Admin nome</label>
                <input name="adminName" class="form-control" value="<%= cfg.adminName %>" placeholder="Nome do admin">
              </div>
              <button class="btn btn-primary btn-sm mt-2" type="submit">Salvar</button>
            </form>
          </div>
        </div>
      </div>

      <div class="col-lg-6">
        <div class="card panel">
          <div class="card-body">
            <div class="fw-semibold mb-2">Seguran√ßa</div>
            <form method="POST" action="/configuracoes/senha">
              <div class="mb-2">
                <label class="form-label small">Nova senha</label>
                <input name="novaSenha" type="password" class="form-control" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
              </div>
              <div class="mb-2">
                <label class="form-label small">Confirmar</label>
                <input name="novaSenha2" type="password" class="form-control" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
              </div>
              <button class="btn btn-outline-primary btn-sm mt-2" type="submit">Alterar senha</button>
            </form>
            <hr>
            <div class="small text-secondary">
              <div><b>Dica:</b> senha e segredos devem ficar em vari√°veis de ambiente (Render).</div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-12">
        <div class="card panel">
          <div class="card-body">
            <div class="fw-semibold mb-2">Status do ambiente</div>
            <div class="row g-2 small">
              <div class="col-md-4"><span class="text-secondary">DATABASE_SSL:</span> <b><%= cfg.databaseSSL ? 'true' : 'false' %></b></div>
              <div class="col-md-4"><span class="text-secondary">Node env:</span> <b><%= (typeof process !== 'undefined' && process.env && process.env.NODE_ENV) ? process.env.NODE_ENV : 'dev' %></b></div>
              <div class="col-md-4"><span class="text-secondary">App:</span> <b>ivplast-reclamacoes</b></div>
            </div>
          </div>
        </div>
      </div>

    </div>

  </main>
</div>
</body>
</html>
