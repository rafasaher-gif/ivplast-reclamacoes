<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <title>Nova Ocorr√™ncia - IVPLAST</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#f4f6fb}
    .layout{display:flex;min-height:100vh}
    .sidebar{width:250px;background:#fff;border-right:1px solid #e5e7eb;padding:18px}
    .logo{font-weight:800;color:#2563eb;margin-bottom:20px}
    .menu a{display:block;padding:10px 12px;border-radius:8px;color:#111;text-decoration:none;margin-bottom:6px}
    .menu a.active{background:#eef2ff;color:#1d4ed8;font-weight:600}
    .menu a:hover{background:#f1f5f9}
    .content{flex:1;padding:24px}
    .top{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:16px;margin-bottom:16px}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:20px}
    h1{margin:0;font-size:22px}
    p.sub{margin:4px 0 0;color:#64748b;font-size:13px}
    label{display:block;font-size:13px;margin:10px 0 6px}
    input,select,textarea{
      width:100%;padding:10px;border:1px solid #d1d5db;border-radius:8px;font-size:14px
    }
    textarea{min-height:110px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .grid3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px}
    .section{margin-top:18px;font-weight:700;font-size:14px}
    .radioRow{display:flex;gap:20px;padding:10px;border:1px solid #d1d5db;border-radius:8px}
    .radioRow label{margin:0;font-size:14px}
    .actions{display:flex;justify-content:flex-end;gap:10px;margin-top:20px}
    .btn{padding:10px 14px;border-radius:8px;border:1px solid #d1d5db;background:#fff;cursor:pointer}
    .btn.primary{background:#2563eb;color:#fff;border-color:#2563eb}
    .hint{font-size:12px;color:#64748b;margin-top:4px}
    @media(max-width:900px){.sidebar{display:none}.grid,.grid3{grid-template-columns:1fr}}
  </style>
</head>

<body>
<div class="layout">

  <!-- MENU -->
  <aside class="sidebar">
    <div class="logo">IVPLAST</div>
    <div class="menu">
      <a href="/dashboard">üè† Menu Principal</a>
      <a href="/novo" class="active">‚ûï Novo</a>
      <a href="/ocorrencias">üîç Busca por Ocorr√™ncia</a>
      <a href="/relatorios">üìä Relat√≥rios</a>
      <a href="/configuracoes">‚öôÔ∏è Configura√ß√µes</a>
      <a href="/auditoria">üßæ Auditoria</a>
      <a href="/logout">üö™ Sair</a>
    </div>
  </aside>

  <!-- CONTE√öDO -->
  <main class="content">

    <div class="top">
      <h1>Nova Ocorr√™ncia</h1>
      <p class="sub">Preencha os dados para registrar a solicita√ß√£o.</p>
      <p class="sub">Logado como: <b><%= usuario.nome %></b></p>
    </div>

    <div class="card">
      <form method="POST" action="/novo" enctype="multipart/form-data">

        <div class="section">Cliente</div>
        <div class="grid">
          <div>
            <label>Raz√£o social</label>
            <input name="razao_social" required>
          </div>
          <div>
            <label>CNPJ</label>
            <input name="cnpj">
          </div>
        </div>

        <div class="grid">
          <div>
            <label>N√∫mero do Pedido</label>
            <input name="numero_pedido">
          </div>
          <div>
            <label>N√∫mero da Nota Fiscal</label>
            <input name="numero_nf">
          </div>
        </div>

        <div class="section">Classifica√ß√£o</div>
        <div class="grid">
          <div>
            <label>Empresa do problema</label>
            <select name="empresa">
              <option value="IVPLAST">IVPLAST</option>
              <option value="VENANI">VENANI</option>
            </select>
          </div>
          <div>
            <label>Motivo / Origem</label>
            <select name="motivo">
              <option value="IVPLAST">IVPLAST</option>
              <option value="Cliente">Cliente</option>
              <option value="Transportadora">Transportadora</option>
              <option value="Vendedor">Vendedor</option>
            </select>
          </div>
        </div>

        <div class="grid3">
          <div>
            <label>Respons√°vel</label>
            <select name="responsavel">
              <option>Atendimento</option>
              <option>Comercial</option>
              <option>Qualidade</option>
              <option>Log√≠stica</option>
              <option>Financeiro</option>
              <option>Diretoria</option>
            </select>
          </div>

          <% if (canSeeCost) { %>
          <div>
            <label>Custo estimado (R$)</label>
            <input name="custo_estimado">
          </div>
          <% } else { %>
            <input type="hidden" name="custo_estimado">
          <% } %>

          <div>
            <label>Anexos</label>
            <input type="file" name="anexos" multiple>
          </div>
        </div>

        <div class="section">Cliente j√° emitiu NFD?</div>
        <div class="grid">
          <div class="radioRow">
            <label><input type="radio" name="cliente_emitiu_nfd" value="nao" checked> N√£o</label>
            <label><input type="radio" name="cliente_emitiu_nfd" value="sim"> Sim</label>
          </div>
          <div>
            <label>N√∫mero da NFD</label>
            <input id="nfd" name="nfd_numero" disabled>
          </div>
        </div>

        <div class="section">Algum item foi errado?</div>
        <div class="grid">
          <div class="radioRow">
            <label><input type="radio" name="item_errado" value="nao" checked> N√£o</label>
            <label><input type="radio" name="item_errado" value="sim"> Sim</label>
          </div>
          <div>
            <label>Item (c√≥digo / descri√ß√£o)</label>
            <input id="item" name="item_descricao" disabled>
          </div>
        </div>

        <div class="grid">
          <div>
            <label>Quantidade</label>
            <input id="qtd" name="item_quantidade" disabled>
          </div>
          <div>
            <label>Observa√ß√µes</label>
            <input name="item_obs">
          </div>
        </div>

        <div class="section">Descri√ß√£o</div>
        <textarea name="descricao" required></textarea>

        <div class="actions">
          <a class="btn" href="/ocorrencias">Cancelar</a>
          <button class="btn primary" type="submit">Salvar ocorr√™ncia</button>
        </div>
      </form>
    </div>
  </main>
</div>

<script>
  function toggleNFD(){
    const sim=document.querySelector('input[name="cliente_emitiu_nfd"][value="sim"]').checked;
    document.getElementById("nfd").disabled=!sim;
  }
  function toggleItem(){
    const sim=document.querySelector('input[name="item_errado"][value="sim"]').checked;
    document.getElementById("item").disabled=!sim;
    document.getElementById("qtd").disabled=!sim;
  }
  document.querySelectorAll('input[name="cliente_emitiu_nfd"]').forEach(e=>e.addEventListener("change",toggleNFD));
  document.querySelectorAll('input[name="item_errado"]').forEach(e=>e.addEventListener("change",toggleItem));
</script>

</body>
</html>
